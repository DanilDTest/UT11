Процедура ОтложеннаяОбработка_ЗаказПокупателяПолный(Объект, КомпонентыОбмена)
	ДанныеОбъект = Объект;                
	///          
	ДанныеОбъект.Согласован = Истина;
	ДанныеОбъект.ПорядокОплаты = Перечисления.ПорядокОплатыПоСоглашениям.РасчетыВВалютеОплатаВВалюте;
	ДанныеОбъект.ДатаСогласования = ДанныеОбъект.Дата;  
	ДанныеОбъект.СпособДоставки = Перечисления.СпособыДоставки.Самовывоз;                          
	ДанныеОбъект.НазначениеПлатежа = СтрШаблон("Заказ клиента %1 от %2", ДанныеОбъект.Номер, ДанныеОбъект.Дата);
	ЗаполнениеСоглашенияСКлиентомВШапкеДокумента(ДанныеОбъект, ДанныеОбъект.ХозяйственнаяОперация, Истина, Истина); 
	/////       
	      
	ДанныеОбъект.Грузоотправитель = Константы.RM_КонтрагентКазахстана.Получить();      
	ЗаполнитьБанковскийСчетКонтрагента(ДанныеОбъект, ДанныеОбъект.Грузоотправитель, ДанныеОбъект.Валюта, "БанковскийСчетГрузоотправителя"); 
	ЗаполнитьБанковскийСчетКонтрагента(ДанныеОбъект, ДанныеОбъект.Грузополучатель, ДанныеОбъект.Валюта, "БанковскийСчетГрузополучателя");
	//ДанныеОбъект.БанковскийСчетКонтрагента = ДанныеОбъект.БанковскийСчетГрузополучателя; 
	                                      
	        
	СтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(ДанныеОбъект);     	
	
	СтруктураДействий = Новый Структура;
	СтруктураДействий.Вставить("ПересчитатьСуммуНДС", СтруктураПересчетаСуммы);
	СтруктураДействий.Вставить("ПересчитатьСуммуСНДС", СтруктураПересчетаСуммы);
	СтруктураДействий.Вставить("ПересчитатьСумму");
	СтруктураДействий.Вставить("ПересчитатьСуммуСУчетомРучнойСкидки", Новый Структура("Очищать", Ложь));
	СтруктураДействий.Вставить("ПересчитатьСуммуСУчетомАвтоматическойСкидки", Новый Структура("Очищать", Истина));
		           
	ОбработкаТабличнойЧастиСервер.ОбработатьТЧ(ДанныеОбъект.Товары, СтруктураДействий, Неопределено);
	                  
	Для каждого СтрокаТовара из ДанныеОбъект.Товары Цикл
		СтрокаТовара.Склад = ДанныеОбъект.Склад;
		СтрокаТовара.ДатаОтгрузки = ДанныеОбъект.ЖелаемаяДатаОтгрузки;  
		СтрокаТовара.ВариантОбеспечения = Перечисления.ВариантыОбеспечения.Отгрузить;
	КонецЦикла;
	                                      
	ДанныеОбъект.СуммаДокумента = ДанныеОбъект.ПолучитьСуммуЗаказанныхСтрок();     
	ДанныеОбъект.ЗаполнитьЭтапыГрафикаОплаты();
КонецПроцедуры
