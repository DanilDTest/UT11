Процедура ОтложеннаяОбработка_СФВыданныйАванс(Объект)
	Если Не ЗначениеЗаполнено(Объект.ПравилоОтбораАванса) Тогда
		Объект.ПравилоОтбораАванса = 
			УчетнаяПолитика.ПравилоОтбораАвансовДляРегистрацииСчетовФактур(Объект.Организация, Объект.Дата);
	КонецЕсли;
	
	Для Каждого Строка Из Объект.Авансы Цикл
		
		Если ЗначениеЗаполнено(Строка.ТипЗапасов) Тогда
			Продолжить;
		ИначеЕсли НЕ ЗначениеЗаполнено(Строка.Номенклатура) Тогда
			Строка.ТипЗапасов = Перечисления.ТипыЗапасов.Товар;
			Продолжить;
		КонецЕсли;
		
		Реквизиты = Новый Структура();
		Реквизиты.Вставить("ТипНоменклатуры",       "ТипНоменклатуры");
		
		ЗначенияРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Строка.Номенклатура, Реквизиты);
	
		Если ЗначенияРеквизитов.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Услуга 
			Или ЗначенияРеквизитов.ТипНоменклатуры = Перечисления.ТипыНоменклатуры.Работа Тогда
			Строка.ТипЗапасов = Перечисления.ТипыЗапасов.Услуга;
		Иначе
			Строка.ТипЗапасов = Перечисления.ТипыЗапасов.Товар;
		КонецЕсли;
		
	КонецЦикла;
КонецПроцедуры
