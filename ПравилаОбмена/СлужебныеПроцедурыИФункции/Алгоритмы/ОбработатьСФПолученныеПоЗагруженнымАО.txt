Процедура ОбработатьСФПолученныеПоЗагруженнымАО(КомпонентыОбмена)
	СФПолученные = КомпонентыОбмена.ПараметрыКонвертации.СФПолученныеПоЗагруженнымАвансовымОтчетам;
	ТекстЗапроса = "ВЫБРАТЬ ПЕРВЫЕ 1
	|	Ссылка.Контрагент КАК Контрагент,
	|	Ссылка.Организация КАК Организация,
	|	Ссылка.Номер КАК Номер,
	|	Ссылка.ДатаСоставления КАК Дата,
	|	Ссылка.Валюта КАК Валюта,
	|	Ссылка КАК Ссылка
	|ИЗ Документ.СчетФактураПолученный.ДокументыОснования
	|ГДЕ ДокументОснование = &Ссылка И НЕ Ссылка.ПометкаУдаления";
	Для Каждого СтрокаСФ Из СФПолученные Цикл
		Запрос = Новый Запрос;
		Запрос.Текст = ТекстЗапроса;
		Запрос.УстановитьПараметр("Ссылка", СтрокаСФ.ДокументОснование);
		Выборка = Запрос.Выполнить().Выбрать();
		Если Выборка.Следующий() Тогда
			Если Выборка.Организация = СтрокаСФ.Организация
				И Выборка.Контрагент = СтрокаСФ.Контрагент
				И Выборка.Номер = СтрокаСФ.НомерСФ
				И Выборка.Дата = СтрокаСФ.ДатаСФ 
				И Выборка.Валюта = СтрокаСФ.Валюта Тогда
				Продолжить;
			КонецЕсли;
			СФОбъект = Выборка.Ссылка.ПолучитьОбъект();
		Иначе
			СФОбъект = Документы.СчетФактураПолученный.СоздатьДокумент();
			ОснованиеСФ = СФОбъект.ДокументыОснования.Добавить();
			ОснованиеСФ.ДокументОснование = СтрокаСФ.ДокументОснование;
			СФОбъект.КодВидаОперации = "01";
			СФОбъект.Дата = СтрокаСФ.ДокументОснование.Дата;
		КонецЕсли;
		СФОбъект.Организация = СтрокаСФ.Организация;
		СФОбъект.Контрагент = СтрокаСФ.Контрагент;
		СФОбъект.ДатаСоставления = СтрокаСФ.ДатаСФ;
		СФОбъект.Номер = СтрокаСФ.НомерСФ;
		СФОбъект.Валюта = СтрокаСФ.Валюта;
		ОбменДаннымиСервер.УстановитьОбменДаннымиЗагрузка(СФОбъект, Ложь, Ложь, КомпонентыОбмена.УзелКорреспондента);
		Если НЕ СФОбъект.Проведен Тогда
			СФОбъект.Записать(РежимЗаписиДокумента.Запись);
		КонецЕсли;
		RM_ОбменДаннымиXDTOСервер.ВыполнитьПроведениеДокументаПриЗагрузке(КомпонентыОбмена, СФОбъект, Истина);
	КонецЦикла;
КонецПроцедуры
