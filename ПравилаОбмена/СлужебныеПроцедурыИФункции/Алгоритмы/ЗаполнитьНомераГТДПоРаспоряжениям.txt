Процедура ЗаполнитьНомераГТДПоРаспоряжениям(Объект, Товары, ПересчитатьСуммовыеПоказатели) Экспорт
	//++ Запрос #566898, Мазепа М.Ф., 30.01.2025
	ТаблицаТовары = Товары.Выгрузить();
	ТаблицаТовары.Свернуть("Номенклатура", "Сумма,СуммаНДС,СуммаСНДС");
	//-- Запрос #566898, Мазепа М.Ф., 30.01.2025
		
	ПараметрыЗаполнения = НоменклатураСервер.ПараметрыЗаполненияНомеровГТД();
	ПараметрыЗапроса = ПараметрыЗаполнения.ПараметрыЗапроса;
	ПараметрыЗапроса.Ссылка = Объект.Ссылка;
		
	СтруктураПересчетаСуммы = ОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(Объект);
		
	СтруктураДействий = Новый Структура;
	СтруктураДействий.Вставить("ПересчитатьСумму");
	СтруктураДействий.Вставить("ПересчитатьСуммуНДС",  СтруктураПересчетаСуммы);
	СтруктураДействий.Вставить("ПересчитатьСуммуСНДС", СтруктураПересчетаСуммы);
		
	Если ПересчитатьСуммовыеПоказатели Тогда
		ПараметрыЗаполнения.СтруктураДействий = СтруктураДействий;
	КонецЕсли;
		
	ПараметрыЗаполнения.ИмяПоляРаспоряжение = "ДокументРеализации";
		
	НоменклатураСервер.ЗаполнитьНомераГТД(Товары, "ПоРаспоряжениям", ПараметрыЗаполнения);
		
	Если Не ПересчитатьСуммовыеПоказатели Тогда
		
		ОбработкаТабличнойЧастиСервер.ОбработатьТЧ(Товары, СтруктураДействий, Неопределено);
		
		//++ Запрос #566898, Мазепа М.Ф., 30.01.2025
		Для Каждого СтрокаТаблицыТовары Из ТаблицаТовары Цикл
			
			СтрокиТовара = Товары.НайтиСтроки(Новый Структура("Номенклатура", СтрокаТаблицыТовары.Номенклатура));
			
			Если СтрокиТовара.Количество() > 0 Тогда
				
				Сумма = 0;
				СуммаНДС = 0;
				СуммаСНДС = 0;
				
				Для Каждого СтрокаТовара Из СтрокиТовара Цикл
					Сумма = Сумма + СтрокаТовара.Сумма;
					СуммаНДС = СуммаНДС + СтрокаТовара.СуммаНДС;
					СуммаСНДС = СуммаСНДС + СтрокаТовара.СуммаСНДС;
				КонецЦикла;
				
				Индекс = СтрокиТовара.ВГраница();
				
				Если Сумма <> СтрокаТаблицыТовары.Сумма Тогда
					СтрокиТовара[Индекс].Сумма = СтрокиТовара[Индекс].Сумма + СтрокаТаблицыТовары.Сумма - Сумма;
				КонецЕсли;
				
				Если СуммаНДС <> СтрокаТаблицыТовары.СуммаНДС Тогда
					СтрокиТовара[Индекс].СуммаНДС = СтрокиТовара[Индекс].СуммаНДС + СтрокаТаблицыТовары.СуммаНДС - СуммаНДС;
				КонецЕсли;
					
				Если Сумма <> СтрокаТаблицыТовары.Сумма Тогда
					СтрокиТовара[Индекс].СуммаСНДС = СтрокиТовара[Индекс].СуммаСНДС + СтрокаТаблицыТовары.СуммаСНДС - СуммаСНДС;
				КонецЕсли;
				
			КонецЕсли;
					
		КонецЦикла;
			
		Объект.СуммаДокумента = ТаблицаТовары.Итог("СуммаСНДС");
		//-- Запрос #566898, Мазепа М.Ф., 30.01.2025
		
	КонецЕсли;
КонецПроцедуры
