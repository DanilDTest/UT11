Процедура ПКО_Справочник_АналитикаРасхожденийПриПриемке_Получени_ПередЗаписьюПолученныхДанных(ПолученныеДанные, ДанныеИБ, КонвертацияСвойств, КомпонентыОбмена)
	Документ_УпаковочныйЛист = RM_ОбменДаннымиXDTOСервер.ПКОПоИмени(КомпонентыОбмена,"Документ_УпаковочныйЛист_Получение");
		Документ_ПеремещениеТоваров = RM_ОбменДаннымиXDTOСервер.ПКОПоИмени(КомпонентыОбмена,"Документ_ПеремещениеТоваров_Получение");
		Справочник_Склады = RM_ОбменДаннымиXDTOСервер.ПКОПоИмени(КомпонентыОбмена,"Справочник_Склады_Получение");
		Справочник_Номенклатура = RM_ОбменДаннымиXDTOСервер.ПКОПоИмени(КомпонентыОбмена,"Справочник_Номенклатура_Получение");
		
		СтруктураИзмеренийРегистра = Новый Структура;
		СтруктураИзмеренийРегистра.Вставить("Номенклатура");
		СтруктураИзмеренийРегистра.Вставить("Склад");
		СтруктураИзмеренийРегистра.Вставить("ПеремещениеТоваров");
		СтруктураИзмеренийРегистра.Вставить("УпаковочныйЛист");
		
		Для каждого ИзмерениеРегистра из СтруктураИзмеренийРегистра Цикл
			Значение = ПолученныеДанные.ДополнительныеСвойства[ИзмерениеРегистра.Ключ];
			
			Если Значение = Неопределено Тогда
				Продолжить;
			ИначеЕсли ТипЗнч(Значение) = Тип("Структура") Тогда
				
				Если ИзмерениеРегистра.Ключ = "УпаковочныйЛист" Тогда
					ПКО = Документ_УпаковочныйЛист;
				ИначеЕсли ИзмерениеРегистра.Ключ = "Склад" Тогда
					ПКО = Справочник_Склады;  
				ИначеЕсли ИзмерениеРегистра.Ключ = "ПеремещениеТоваров" Тогда
					ПКО = Документ_ПеремещениеТоваров;
				Иначе
					ПКО = Справочник_Номенклатура;
				КонецЕсли;
				
				Значение = RM_ОбменДаннымиXDTOСервер.СтруктураОбъектаXDTOВДанныеИБ(КомпонентыОбмена, 
					Значение, 
					ПКО, 
					"ПолучитьСсылку").Ссылка;	
					
			КонецЕсли;
		
			 ПолученныеДанные.Отбор[ИзмерениеРегистра.Ключ].Значение = Значение;
			 ПолученныеДанные.Отбор[ИзмерениеРегистра.Ключ].Использование = Истина;
		КонецЦикла;
		
			
		// Добавление записей в набор записей.		
		Если ПолученныеДанные.ДополнительныеСвойства.Записи <> Неопределено Тогда
			
			Для Каждого Запись Из ПолученныеДанные.ДополнительныеСвойства.Записи Цикл   
			
			ЗаписьЖурналаРегистрации("Тест", УровеньЖурналаРегистрации.Примечание, ,,"ЕстьЗаписи");
	
				
				СтрокаЗаписи          = ПолученныеДанные.Добавить();
				СтрокаЗаписи.КоличествоПлан = Запись.КоличествоПлан;
				СтрокаЗаписи.КоличествоФакт = Запись.КоличествоФакт;
				СтрокаЗаписи.Расхождение = Запись.КоличествоРасхождение; 
				СтрокаЗаписи.ДатаПриемки = Запись.ДатаПриемки;
				
				
				Для каждого ИзмерениеРегистра из СтруктураИзмеренийРегистра Цикл
					
					Значение = Запись[ИзмерениеРегистра.Ключ];
					
					Если ТипЗнч(Значение) = Тип("Структура") Тогда
						
						Если ИзмерениеРегистра.Ключ = "УпаковочныйЛист" Тогда
							ПКО = Документ_УпаковочныйЛист;
						ИначеЕсли ИзмерениеРегистра.Ключ = "Склад" Тогда
							ПКО = Справочник_Склады;  
						ИначеЕсли ИзмерениеРегистра.Ключ = "ПеремещениеТоваров" Тогда
							ПКО = Документ_ПеремещениеТоваров;
						Иначе
							ПКО = Справочник_Номенклатура;
						КонецЕсли;
						
						Значение = RM_ОбменДаннымиXDTOСервер.СтруктураОбъектаXDTOВДанныеИБ(КомпонентыОбмена, 
						Значение, 
						ПКО, 
						"ПолучитьСсылку").Ссылка;	
						
						
					КонецЕсли;
					
					
					СтрокаЗаписи[ИзмерениеРегистра.Ключ] = Значение;
					
					
				КонецЦикла;			
				
				
			КонецЦикла;
			
		КонецЕсли;
КонецПроцедуры
