Процедура ПКО_Документ_АннулированиеПС_Получение_ПриКонвертацииДанныхXDTO(ДанныеXDTO, ПолученныеДанные, КомпонентыОбмена)
	ПолученныеДанные.Проведен = Истина;
	
	ЗагрузитьДополнительныеРеквизиты(ПолученныеДанные, ДанныеXDTO, КомпонентыОбмена);
	
	// ПодарочныеСертификаты
	МассивСтрокТовары = Новый Массив;
	
	Если ДанныеXDTO.Свойство("ПодарочныеСертификаты")
		И ЗначениеЗаполнено(ДанныеXDTO.ПодарочныеСертификаты) Тогда
		
		Для Каждого Строка Из ДанныеXDTO.ПодарочныеСертификаты Цикл
			
			СтруктураПодарочногоСертификата = Новый Структура;
			СтруктураПодарочногоСертификата.Вставить("Штрихкод",                  Строка.Штрихкод);
			СтруктураПодарочногоСертификата.Вставить("МагнитныйКод",              Строка.МагнитныйКод);
			СтруктураПодарочногоСертификата.Вставить("СерийныйНомер",             Строка.СерийныйНомер);
			
			// Готовим инструкцию для конвертации подарочного сертификата.
			Инструкция = Новый Структура;
			
			
			СтруктураПодарочногоСертификата.Вставить("ВидПодарочногоСертификата", Строка.ВидПодарочногоСертификата);
			Инструкция.Вставить("ИмяПКО", "Справочник_ПодарочныеСертификаты");
			
			Инструкция.Вставить("Значение", СтруктураПодарочногоСертификата);
	
			СтруктураДанныхСтроки = Новый Структура;
			СтруктураДанныхСтроки.Вставить("СуммаВВалютеСертификата", Строка.Сумма);
			СтруктураДанныхСтроки.Вставить("ПодарочныйСертификат",    Инструкция);
			
			МассивСтрокТовары.Добавить(СтруктураДанныхСтроки);
			
		КонецЦикла;
	КонецЕсли;
	
	ПолученныеДанные.ДополнительныеСвойства.Вставить("ПодарочныеСертификаты", МассивСтрокТовары);
КонецПроцедуры
