Процедура ПКО_Справочник_СостояниеЗаказа_Отправка_ПриОтправкеДанных(ДанныеИБ, ДанныеXDTO, КомпонентыОбмена, СтекВыгрузки)
	Заказ = ДанныеИБ.Отбор.Заказ.Значение;
	ДанныеXDTO.КлючевыеСвойства.Вставить("Заказ", Заказ);
	
	ТаблицаЗаписи = ДанныеИБ.Выгрузить();
	ДанныеXDTO.Вставить("ДатаСостояния", ТаблицаЗаписи[0].ДатаСобытия);
	
	Если ЗаказОтменен(Заказ) Тогда
	
		СостояниеЗаказа = "Отменен";
		СостояниеЗаказаСтрокой = "Отменен";
	
	ИначеЕсли ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ОжидаетсяСогласование Тогда
	
		СостояниеЗаказа = "Принят";
		СостояниеЗаказаСтрокой = "Принят";
	
	ИначеЕсли ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ОжидаетсяАвансДоОбеспечения
		Или ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ОжидаетсяПредоплатаДоОтгрузки Тогда
		
		СостояниеЗаказа = "Подтвержден";
		СостояниеЗаказаСтрокой = "Подтвержден";
	
	ИначеЕсли ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ГотовКОбеспечению
		Или ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ОжидаетсяОбеспечение Тогда
		
		СостояниеЗаказа = "Комплектуется";
		СостояниеЗаказаСтрокой = "Комплектуется";
		
		
	ИначеЕсли ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ГотовКОтгрузке
		Или ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ВПроцессеОтгрузки Тогда
		
		СостояниеЗаказа = "ГотовКВыдаче";
		СостояниеЗаказаСтрокой = "ГотовКВыдаче";
		
	ИначеЕсли ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ОжидаетсяОплатаПослеОтгрузки
		Или ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.ГотовКЗакрытию
		Или ТаблицаЗаписи[0].Состояние = Перечисления.СостоянияЗаказовКлиентов.Закрыт Тогда
	
		СостояниеЗаказа = "Выполнен";
		СостояниеЗаказаСтрокой = "Выполнен";
	
	КонецЕсли;	
	
	ДанныеXDTO.Вставить("СостояниеЗаказа", СостояниеЗаказа);
	ДанныеXDTO.Вставить("СостояниеЗаказаСтрокой", СостояниеЗаказаСтрокой);
КонецПроцедуры
