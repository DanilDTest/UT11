Процедура ПКО_Документ_ОтчетКомитенту_Получение_ПриКонвертацииДанныхXDTO(ДанныеXDTO, ПолученныеДанные, КомпонентыОбмена)
	ПолученныеДанные.Проведен    = Истина;
	ПолученныеДанные.ДатаПлатежа = ПолученныеДанные.Дата;
	ДобавитьВалютуВДопСвойства(ПолученныеДанные, ДанныеXDTO);
	ДобавитьДоговорВДопСвойства(ПолученныеДанные, ДанныеXDTO, КомпонентыОбмена);
	
	Если НЕ ЗначениеЗаполнено(ПолученныеДанные.Услуга) Тогда
		ПолученныеДанные.Услуга = ЭлементПоУмолчанию(КомпонентыОбмена, "НоменклатураУслуга");
	КонецЕсли;
	
	#Область Товары
	
	ПравилаЗаполнения = Новый Соответствие;
	ПравилаЗаполнения.Вставить("Номенклатура",           "Номенклатура");
	ПравилаЗаполнения.Вставить("Количество",             "Количество");
	ПравилаЗаполнения.Вставить("Сумма",                  "Сумма");
	ПравилаЗаполнения.Вставить("СуммаВознаграждения",    "СуммаВознаграждения");
	ПравилаЗаполнения.Вставить("СуммаПоступления",       "СуммаПродажи");
	ПравилаЗаполнения.Вставить("Цена",                   "Цена");
	ПравилаЗаполнения.Вставить("ЦенаПоступления",        "ЦенаПродажи");
	ПравилаЗаполнения.Вставить("СтавкаНДС",              "СтавкаНДС");
	ПравилаЗаполнения.Вставить("СуммаНДС",               "СуммаНДС");
	Если ЗначениеФО("ИспользоватьХарактеристикиНоменклатуры", КомпонентыОбмена) Тогда
		ПравилаЗаполнения.Вставить("Характеристика",     "Характеристика");
	КонецЕсли;
	Если ЗначениеФО("ИспользоватьУпаковкиНоменклатуры", КомпонентыОбмена) Тогда
		ПравилаЗаполнения.Вставить("Упаковка",           "Упаковка");
		ПравилаЗаполнения.Вставить("КоличествоУпаковок", "КоличествоУпаковок");
	КонецЕсли;
	
	МассивСтрокТовары = Новый Массив;
	Для Каждого Строка Из ДанныеXDTO.Товары Цикл
		
		СтруктураДанныхСтроки = ДанныеКоллекцииВВидеСтруктуры(Строка, ПравилаЗаполнения);
		
		Если НЕ СтруктураДанныхСтроки.Свойство("КоличествоУпаковок") Тогда
			СтруктураДанныхСтроки.Вставить("КоличествоУпаковок", СтруктураДанныхСтроки.Количество);
		КонецЕсли;
		Если СтруктураДанныхСтроки.Свойство("Сумма") Тогда
			СтруктураДанныхСтроки.Вставить("Цена", СтруктураДанныхСтроки.Сумма / СтруктураДанныхСтроки.КоличествоУпаковок);
		КонецЕсли;
		Если СтруктураДанныхСтроки.Свойство("СуммаПродажи") Тогда
			СтруктураДанныхСтроки.Вставить("ЦенаПродажи", СтруктураДанныхСтроки.СуммаПродажи / СтруктураДанныхСтроки.КоличествоУпаковок);
		КонецЕсли;	
		
		МассивСтрокТовары.Добавить(СтруктураДанныхСтроки);
		
	КонецЦикла;
	
	ПолученныеДанные.ДополнительныеСвойства.Вставить("Товары", МассивСтрокТовары);
	
	#КонецОбласти
КонецПроцедуры
