Процедура ПКО_Справочник_Упаковки_ПриОтправкеДанных(ДанныеИБ, ДанныеXDTO, КомпонентыОбмена, СтекВыгрузки)
	Коэффициент = ?(ДанныеИБ.Знаменатель = 0, ДанныеИБ.Числитель, Окр(ДанныеИБ.Числитель / ДанныеИБ.Знаменатель,3));
	
	Номенклатура = Неопределено;
	Если ВерсияФорматаЧислом(КомпонентыОбмена.ВерсияФорматаОбмена) >= ВерсияФорматаЧислом("1.6") Тогда
		Если ЗначениеЗаполнено(ДанныеИБ.Владелец) И ТипЗнч(ДанныеИБ.Владелец) = Тип("СправочникСсылка.Номенклатура") Тогда
			Номенклатура = ДанныеИБ.Владелец;
		КонецЕсли;
	КонецЕсли;
	
	Если СтекВыгрузки.Количество() > 1 Тогда
		ДанныеXDTO.Вставить("Коэффициент", Коэффициент);
		Если ЗначениеЗаполнено(Номенклатура) Тогда  
			ДанныеНоменклатуры = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(ДанныеИБ.Номенклатура, "Артикул, Наименование, Ссылка");  
			ДанныеНоменклатуры.Вставить("ИдентификаторСервиса1СНоменклатура", ""); 
			ДанныеXDTO.Вставить("Номенклатура", Новый Структура("Значение, ИмяПКО", ДанныеНоменклатуры, "Справочник_Номенклатура_Из_Структуры"));   
			
			//ДанныеXDTO.Вставить("Номенклатура", Номенклатура);
		КонецЕсли;
		Возврат;
	КонецЕсли;
	
	ДанныеXDTO.КлючевыеСвойства.Вставить("Коэффициент", Коэффициент);
	Если ЗначениеЗаполнено(Номенклатура) Тогда
		ДанныеXDTO.КлючевыеСвойства.Вставить("Номенклатура", Номенклатура);
	КонецЕсли;
	
	Если ВерсияФорматаЧислом(КомпонентыОбмена.ВерсияФорматаОбмена) < ВерсияФорматаЧислом("1.7") Тогда
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Высота) Тогда
			ДанныеXDTO.Вставить("Высота", -1);
		КонецЕсли;
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Глубина) Тогда
			ДанныеXDTO.Вставить("Глубина", -1);
		КонецЕсли;
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Объем) Тогда
			ДанныеXDTO.Вставить("Объем", -1);
		КонецЕсли;
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Ширина) Тогда
			ДанныеXDTO.Вставить("Ширина", -1);
		КонецЕсли;
	КонецЕсли;         
	
	
	СтруктураДополнительныхРеквизитов = Новый Структура;
	СтруктураДополнительныхРеквизитов.Вставить("ЛинейныеРазмерыПредставление", ДанныеИБ.ЛинейныеРазмерыПредставление);
	СтруктураДополнительныхРеквизитов.Вставить("RM_КоэффициентВложенности", ДанныеИБ.RM_КоэффициентВложенности);
	СтруктураДополнительныхРеквизитов.Вставить("Числитель", ДанныеИБ.Числитель);
	СтруктураДополнительныхРеквизитов.Вставить("КоличествоУпаковок", ДанныеИБ.КоличествоУпаковок);
	СтруктураДополнительныхРеквизитов.Вставить("НаименованиеПолное", ДанныеИБ.НаименованиеПолное);
	СтруктураДополнительныхРеквизитов.Вставить("МеждународноеСокращение", ДанныеИБ.МеждународноеСокращение);
	СтруктураДополнительныхРеквизитов.Вставить("Знаменатель", ДанныеИБ.Знаменатель);
	СтруктураДополнительныхРеквизитов.Вставить("Безразмерная", ДанныеИБ.Безразмерная);
	СтруктураДополнительныхРеквизитов.Вставить("ПоставляетсяВМногооборотнойТаре", ДанныеИБ.ПоставляетсяВМногооборотнойТаре);
	СтруктураДополнительныхРеквизитов.Вставить("ВысотаЕдиницаИзмерения", ДанныеИБ.ВысотаЕдиницаИзмерения);
	
	ЗаполнитьЗначенияСвойств(СтруктураДополнительныхРеквизитов, ДанныеИБ);  
	ВыгрузитьДополнительныеРеквизитыСвойствоСтрокой(СтруктураДополнительныхРеквизитов, ДанныеXDTO);
КонецПроцедуры
