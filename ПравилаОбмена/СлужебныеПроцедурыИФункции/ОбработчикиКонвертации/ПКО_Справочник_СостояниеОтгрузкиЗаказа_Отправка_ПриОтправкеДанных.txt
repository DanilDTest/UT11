Процедура ПКО_Справочник_СостояниеОтгрузкиЗаказа_Отправка_ПриОтправкеДанных(ДанныеИБ, ДанныеXDTO, КомпонентыОбмена, СтекВыгрузки)
	Заказ = ДанныеИБ.Отбор.Заказ.Значение;
	ДанныеXDTO.КлючевыеСвойства.Вставить("Заказ", Заказ);
	
	ТаблицаЗаписи = ДанныеИБ.Выгрузить();
	
	ДанныеXDTO.Вставить("ДатаСостояния", ТаблицаЗаписи[0].ДатаСобытия);
	
	Если ТаблицаЗаписи[0].ПроцентОтгрузки = 100 Тогда
		СостояниеОтгрузки = "Отгружен";
	ИначеЕсли ЗаказОтменен(Заказ) Тогда
		СостояниеОтгрузки = "Отменен";
	ИначеЕсли ТаблицаЗаписи[0].ПроцентОтгрузки > 0 Тогда
		СостояниеОтгрузки = "ОтгруженЧастично";
	Иначе
		СостояниеОтгрузки = "НеОтгружен";
	КонецЕсли;	
	
	ДанныеXDTO.Вставить("СостояниеОтгрузки", СостояниеОтгрузки);
КонецПроцедуры
