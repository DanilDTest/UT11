Процедура ПКО_Документ_ПриходныйОрдерНаТовары_Получение_ПриКонвертацииДанныхXDTO(ДанныеXDTO, ПолученныеДанные, КомпонентыОбмена)
	ЗначениеСсылкиРаспоряжения = "";
	СсылкаИБРаспоряжения = Неопределено;
	Если ДанныеXDTO.Свойство("Распоряжение") И ЗначениеЗаполнено(ДанныеXDTO.Распоряжение) 
		И ТипЗнч(ДанныеXDTO.Распоряжение) = Тип("Структура") И ДанныеXDTO.Распоряжение.Свойство("Ссылка") Тогда
		
		ЗначениеСсылкиРаспоряжения = ДанныеXDTO.Распоряжение.Ссылка;
		ИмяЗначения = ДанныеXDTO.Распоряжение.Ссылка.ТипЗначенияXDTO.Имя; 
		ИмяПКО = "";
		
		Если ИмяЗначения = "ДокументСсылка.ПеремещениеТоваров" Тогда
			ИмяПКО = "Документ_ПеремещениеТоваров_Получение";
		ИначеЕсли ИмяЗначения = "ДокументСсылка.ЗаказНаПеремещение" Тогда 
			ИмяПКО = "Документ_ЗаказНаПеремещение_Получение";  
		ИначеЕсли ИмяЗначения = "ДокументСсылка.ЗаказПоставщику" Тогда 
			ИмяПКО = "Документ_ЗаказПоставщику_Получение";
		ИначеЕсли ИмяЗначения = "ДокументСсылка.ЗаказНаСборку" Тогда 
			ИмяПКО = "Документ_ЗаказНаСборку_Получение";
		КонецЕсли;    
		
		
		Если НЕ ИмяПКО = "" Тогда     
			
			ПолученныеДанные.ДополнительныеСвойства.Вставить("Распоряжение", Новый Структура("ИмяПКО,Значение", ИмяПКО, ДанныеXDTO.Распоряжение));
		
		КонецЕсли;                                                   
	КонецЕсли;    
	          
	          
	Если ДанныеXDTO.Свойство("ДокументОснование") И ЗначениеЗаполнено(ДанныеXDTO.ДокументОснование) 
		И ТипЗнч(ДанныеXDTO.ДокументОснование) = Тип("Структура") И ДанныеXDTO.ДокументОснование.Свойство("Ссылка") Тогда
	
		Если ЗначениеСсылкиРаспоряжения = ДанныеXDTO.ДокументОснование.Ссылка Тогда
			ПолученныеДанные.RM_ДокументОснование = СсылкаИБРаспоряжения;
		Иначе 	
			ИмяЗначения = ДанныеXDTO.ДокументОснование.Ссылка.ТипЗначенияXDTO.Имя; 
			ИмяПКО = "";
			
			Если ИмяЗначения = "ДокументСсылка.ПеремещениеТоваров" Тогда
				ИмяПКО = "Документ_ПеремещениеТоваров_Получение";
			ИначеЕсли ИмяЗначения = "ДокументСсылка.ЗаказНаПеремещение" Тогда 
				ИмяПКО = "Документ_ЗаказНаПеремещение_Получение";  
			ИначеЕсли ИмяЗначения = "ДокументСсылка.ЗаказПоставщику" Тогда 
				ИмяПКО = "Документ_ЗаказПоставщику_Получение";  
			ИначеЕсли ИмяЗначения = "ДокументСсылка.ЗаказНаСборку" Тогда 
				ИмяПКО = "Документ_ЗаказНаСборку_Получение";
			КонецЕсли;    
			
			
			Если НЕ ИмяПКО = "" Тогда 
	
				ПолученныеДанные.ДополнительныеСвойства.Вставить("RM_ДокументОснование", Новый Структура("ИмяПКО,Значение", ИмяПКО, ДанныеXDTO.ДокументОснование));
	
			КонецЕсли;      
		КонецЕсли;                                             
	КонецЕсли;
	
	
	
	
	
	
	
	ПравилаЗаполнения = Новый Соответствие;
	ПравилаЗаполнения.Вставить("Номенклатура", "Номенклатура");
	ПравилаЗаполнения.Вставить("Количество",   "Количество");
	ПравилаЗаполнения.Вставить("СтатусУказанияСерий",   "СтатусУказанияСерий");
	ПравилаЗаполнения.Вставить("RM_Факт",   "RM_Факт");   
	ПравилаЗаполнения.Вставить("УпаковочныйЛист",   "УпаковочныйЛист");
	
	Если ЗначениеФО("ИспользоватьУпаковкиНоменклатуры", КомпонентыОбмена) Тогда
		ПравилаЗаполнения.Вставить("Упаковка",           "Упаковка");
		ПравилаЗаполнения.Вставить("КоличествоУпаковок", "КоличествоУпаковок");
	КонецЕсли;
	Если ЗначениеФО("ИспользоватьСерииНоменклатуры", КомпонентыОбмена) Тогда
		ПравилаЗаполнения.Вставить("Серия",              "Серия");
	КонецЕсли;
	    
	Если ДанныеXDTO.Свойство("Товары") Тогда   
		МассивСтрокТовары = Новый Массив;
		Для Каждого Строка Из ДанныеXDTO.Товары Цикл
			СтруктураДанныхСтроки = ДанныеКоллекцииВВидеСтруктуры(Строка, ПравилаЗаполнения);
			Если НЕ (СтруктураДанныхСтроки.Свойство("КоличествоУпаковок") И СтруктураДанныхСтроки.КоличествоУпаковок <> 0) Тогда
				СтруктураДанныхСтроки.Вставить("КоличествоУпаковок", СтруктураДанныхСтроки.Количество);
			КонецЕсли;
			МассивСтрокТовары.Добавить(СтруктураДанныхСтроки);
		КонецЦикла;
		ПолученныеДанные.ДополнительныеСвойства.Вставить("Товары", МассивСтрокТовары);  
	КонецЕсли;
	
	
	#Область ШтрихкодыУпаковок
	
	Если ДанныеXDTO.Свойство("АкцизныеМарки") Тогда
	ПравилаЗаполнения = Новый Соответствие;
	ПравилаЗаполнения.Вставить("ШтрихкодУпаковки", "ШтрихкодУпаковки");
	
	МассивСтрокШтрихкодыУпаковок = Новый Массив;
	Для Каждого Строка Из ДанныеXDTO.АкцизныеМарки Цикл
		СтруктураДанныхСтроки = ДанныеКоллекцииВВидеСтруктуры(Строка, ПравилаЗаполнения);
		МассивСтрокШтрихкодыУпаковок.Добавить(СтруктураДанныхСтроки);
	КонецЦикла;
	ПолученныеДанные.ДополнительныеСвойства.Вставить("RM_ШтрихкодыУпаковок", МассивСтрокШтрихкодыУпаковок);
	КонецЕсли;
	#КонецОбласти  
	
	  
	#Область ПодарочныеСертификаты
	  
	МассивСтрокПодарочныеСертификаты = Новый Массив;
	
	Если ДанныеXDTO.Свойство("ПодарочныеСертификаты") Тогда
		ПравилаЗаполнения = Новый Соответствие;
		ПравилаЗаполнения.Вставить("ПодарочныйСертификат", "ПодарочныйСертификат");
	
		Для Каждого Строка Из ДанныеXDTO.ПодарочныеСертификаты Цикл
			СтруктураДанныхСтроки = ДанныеКоллекцииВВидеСтруктуры(Строка, ПравилаЗаполнения);
			МассивСтрокПодарочныеСертификаты.Добавить(СтруктураДанныхСтроки);
		КонецЦикла;
	КонецЕсли;     
	
	ПолученныеДанные.ДополнительныеСвойства.Вставить("RM_ПодарочныеСертификаты", МассивСтрокПодарочныеСертификаты);
	#КонецОбласти
КонецПроцедуры
