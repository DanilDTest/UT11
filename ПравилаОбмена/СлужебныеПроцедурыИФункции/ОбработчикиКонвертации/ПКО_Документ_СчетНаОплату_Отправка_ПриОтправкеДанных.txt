Процедура ПКО_Документ_СчетНаОплату_Отправка_ПриОтправкеДанных(ДанныеИБ, ДанныеXDTO, КомпонентыОбмена, СтекВыгрузки)
	Если СтекВыгрузки.Количество() > 1 Тогда
		Возврат;
	КонецЕсли;
	
	ВалютаВзаиморасчетов = ДанныеИБ.Валюта;
	
	// Дополнительные свойства для договора
	Если ЗначениеЗаполнено(ДанныеИБ.Договор) Тогда
		
		СвойстваДоговора = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(
			ДанныеИБ.Договор, "ПорядокОплаты, ВалютаВзаиморасчетов");
		
		ДанныеXDTO.Вставить("Договор",                  ДанныеИБ.Договор);
		ДанныеXDTO.Вставить("РасчетыВУсловныхЕдиницах", (СвойстваДоговора.ПорядокОплаты = Перечисления.ПорядокОплатыПоСоглашениям.РасчетыВВалютеОплатаВРублях));
		
		ВалютаВзаиморасчетов = СвойстваДоговора.ВалютаВзаиморасчетов;
		
	Иначе
		
		ПараметрыПоУмолчанию = Новый Структура(ДоговорФиксированнаяСтруктураКлючей());
		ПараметрыПоУмолчанию.Контрагент               = ДанныеИБ.Контрагент;
		ПараметрыПоУмолчанию.Организация              = ДанныеИБ.Организация;
		ПараметрыПоУмолчанию.ВалютаВзаиморасчетов     = ВалютаВзаиморасчетов;
		ПараметрыПоУмолчанию.Дата                     = ДанныеИБ.Дата;
		ПараметрыПоУмолчанию.Номер                    = ДанныеИБ.Номер;
	 	ПараметрыПоУмолчанию.РасчетыВУсловныхЕдиницах = Ложь;
		ПараметрыПоУмолчанию.ВидДоговора
			= ВзаиморасчетыСервер.ВидДоговораКонтрагента(ДанныеИБ.Ссылка, Неопределено, Перечисления.ХозяйственныеОперации.ПоступлениеОплатыОтКлиента);
		
		Заказ = Новый Структура("Заказ, Соглашение, Сделка", ДанныеИБ.Ссылка, Неопределено, Неопределено);
		
		Договор = ДоговорИнструкцияКонвертацииПоДаннымВзаиморасчетов(ПараметрыПоУмолчанию, КомпонентыОбмена, ДанныеИБ.ДокументОснование, ДанныеИБ);
		ДанныеXDTO.Вставить("Договор", Договор);
		ДанныеXDTO.Вставить("РасчетыВУсловныхЕдиницах", Ложь);
		
	КонецЕсли;
КонецПроцедуры
