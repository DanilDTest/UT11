Процедура ПКО_Документ_РасходныйОрдерНаТовары_Получение_ПередЗаписьюПолученныхДанных(ПолученныеДанные, ДанныеИБ, КонвертацияСвойств, КомпонентыОбмена)
	Помещение = Справочники.СкладскиеПомещения.ПустаяСсылка(); 
	ИспользоватьПомещения = Ложь;
	     
	Если НЕ ЗначениеЗаполнено(ПолученныеДанные.Помещение) И ЗначениеЗаполнено(ПолученныеДанные.Склад) Тогда
	 	ИспользоватьПомещения = СкладыСервер.ИспользоватьСкладскиеПомещения(ПолученныеДанные.Склад, ПолученныеДанные.Дата, Истина);
	 	Если ИспользоватьПомещения Тогда
	 	  	ПолученныеДанные.Помещение = ПолучитьПомещениеПоУмолчанию(ПолученныеДанные.Склад); 
	 	  	ПолученныеДанные.ЗонаОтгрузки = ЗонаОтгрузкиПоУмолчанию(ПолученныеДанные.Склад, ПолученныеДанные.Помещение, ПолученныеДанные.ЗонаОтгрузки);
	 	КонецЕсли;
	КонецЕсли;
	     
	Если ДанныеИБ = Неопределено Тогда    
		ПолученныеДанные.Статус = ?(ЗначениеЗаполнено(ПолученныеДанные.Статус), ПолученныеДанные.Статус, Перечисления.СтатусыРасходныхОрдеров.Отгружен);
		ПолученныеДанные.СкладскаяОперация = Перечисления.СкладскиеОперации.ОтгрузкаПоПеремещению;
		ПолученныеДанные.Приоритет = Справочники.Приоритеты.ПолучитьПриоритетПоУмолчанию(ПолученныеДанные.Приоритет);
		ПолученныеДанные.ДатаОтгрузки = ?(ЗначениеЗаполнено(ПолученныеДанные.ДатаОтгрузки),ПолученныеДанные.ДатаОтгрузки, Мин(ТекущаяДата(), ПолученныеДанные.Дата));	      
	Иначе     
		ПолученныеДанные.Статус = ?(ЗначениеЗаполнено(ПолученныеДанные.Статус), ПолученныеДанные.Статус, ДанныеИБ.Статус);
		ПолученныеДанные.Помещение = ?(ЗначениеЗаполнено(ДанныеИБ.Помещение), ДанныеИБ.Помещение, ПолученныеДанные.Помещение);  
		ПолученныеДанные.ДатаОтгрузки = ?(ЗначениеЗаполнено(ПолученныеДанные.ДатаОтгрузки), ПолученныеДанные.ДатаОтгрузки, ДанныеИБ.ДатаОтгрузки);
	КонецЕсли;
КонецПроцедуры
