Процедура ПКО_Документ_СписаниеНедостачТоваров_Получение_ПриКонвертацииДанныхXDTO(ДанныеXDTO, ПолученныеДанные, КомпонентыОбмена)
	ЗагрузитьДополнительныеРеквизиты(ПолученныеДанные, ДанныеXDTO, КомпонентыОбмена);
	                    
	Если ДанныеXDTO.Свойство("АналитикаРасходов")
		И ДанныеXDTO.АналитикаРасходов.Свойство("ТипЗначения") Тогда
		ПолученныеДанные.ДополнительныеСвойства.Вставить("АналитикаРасходов", Новый Структура("Значение, ИмяПКО", ДанныеXDTO.АналитикаРасходов, "Справочник_Организации_Получение"));
	КонецЕсли; 
	                    
	ТипДокументОснования = Неопределено;
	Если ДанныеXDTO.Свойство("ДокументРеализации")
		И ТипЗнч(ДанныеXDTO.RM_ДокументОснование) = Тип("Структура")
		И ДанныеXDTO.RM_ДокументОснование.Свойство("ТипЗначения", ТипДокументОснования) Тогда
		
		ИмяПКО = "";
		Если ТипДокументОснования = "RM_АктБрака" Тогда
			ИмяПКО = "Документ_RM_АктБрака_Получение";
		ИначеЕсли ТипДокументОснования = "АктОРасхожденияхПослеПеремещения" Тогда
			ИмяПКО = "Документ_АктОРасхожденияхПослеПеремещения_Получени";
		КонецЕсли;
		
		Если НЕ ИмяПКО = "" Тогда
			Инструкция = Новый Структура("Значение, ИмяПКО", ДанныеXDTO.RM_ДокументОснование, ИмяПКО);
			ПолученныеДанные.ДополнительныеСвойства.Вставить("Основание", Инструкция);
		КонецЕсли;
	КонецЕсли;
	
	#Область Товары
	
	Если ДанныеXDTO.Свойство("Товары") Тогда
	
	ПравилаЗаполнения = Новый Соответствие;
	ПравилаЗаполнения.Вставить("Номенклатура", "Номенклатура");
	ПравилаЗаполнения.Вставить("Количество",   "Количество");          
	ПравилаЗаполнения.Вставить("ИдентификаторСтроки", "RM_КлючСвязи");
	
	Если ЗначениеФО("ИспользоватьХарактеристикиНоменклатуры", КомпонентыОбмена) Тогда
		ПравилаЗаполнения.Вставить("Характеристика",     "Характеристика");
	КонецЕсли;
	Если ЗначениеФО("ИспользоватьСерииНоменклатуры", КомпонентыОбмена) Тогда
		ПравилаЗаполнения.Вставить("Серия",              "Серия");
	КонецЕсли;
	
	МассивСтрокТовары = Новый Массив;
	Для Каждого Строка Из ДанныеXDTO.Товары Цикл
		
		СтруктураДанныхСтроки = ДанныеКоллекцииВВидеСтруктуры(Строка, ПравилаЗаполнения);
		
		МассивСтрокТовары.Добавить(СтруктураДанныхСтроки);
		
	КонецЦикла;
	
	ПолученныеДанные.ДополнительныеСвойства.Вставить("Товары", МассивСтрокТовары);
	
	КонецЕсли;
	
	#КонецОбласти
КонецПроцедуры
