Процедура ПКО_Документ_ВозвратПодарочныхСертификатов_Получение_ПриКонвертацииДанныхXDTO(ДанныеXDTO, ПолученныеДанные, КомпонентыОбмена)
	Если Не (ДанныеXDTO.Свойство("ПодарочныеСертификаты") И ЗначениеЗаполнено(ДанныеXDTO.ПодарочныеСертификаты)) Тогда
		Возврат;
	КонецЕсли;         
	
	Если ДанныеXDTO.Свойство("УчитыватьНДС") И ДанныеXDTO.УчитыватьНДС Тогда
		ПолученныеДанные.НалогообложениеНДС = Перечисления.ТипыНалогообложенияНДС.ПродажаОблагаетсяНДС; 
	Иначе
	   ПолученныеДанные.НалогообложениеНДС = Перечисления.ТипыНалогообложенияНДС.ПродажаНеОблагаетсяНДС; 
	КонецЕсли;
	
	
	ПолученныеДанные.Статус = Перечисления.СтатусыЧековККМ.Пробит;
	ДобавитьВалютуВДопСвойства(ПолученныеДанные, ДанныеXDTO);
	
	ЗагрузитьДополнительныеРеквизиты(ПолученныеДанные, ДанныеXDTO, КомпонентыОбмена);
	
	// ПодарочныеСертификаты
	МассивСтрокТовары = Новый Массив;
	
	Если ДанныеXDTO.Свойство("ПодарочныеСертификаты")
		И ЗначениеЗаполнено(ДанныеXDTO.ПодарочныеСертификаты) Тогда
		
		Для Каждого Строка Из ДанныеXDTO.ПодарочныеСертификаты Цикл
		
			СтруктураДанныхСтроки = Новый Структура;
			СтруктураДанныхСтроки.Вставить("Сумма", Строка.Сумма);
			СтруктураДанныхСтроки.Вставить("ПодарочныйСертификат", Строка.СертификатСсылка);
			
			МассивСтрокТовары.Добавить(СтруктураДанныхСтроки);
			
		КонецЦикла;
	КонецЕсли;
	
	ПолученныеДанные.ДополнительныеСвойства.Вставить("ПодарочныеСертификаты", МассивСтрокТовары);
КонецПроцедуры
