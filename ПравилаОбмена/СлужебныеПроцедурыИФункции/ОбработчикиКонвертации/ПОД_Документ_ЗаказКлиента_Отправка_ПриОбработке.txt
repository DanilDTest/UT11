Процедура ПОД_Документ_ЗаказКлиента_Отправка_ПриОбработке(ДанныеИБ, ИспользованиеПКО, КомпонентыОбмена)
	Если ДанныеИБ.ПометкаУдаления Тогда
		УстановитьИспользованиеПКО(ИспользованиеПКО, Ложь);
		Возврат;
	КонецЕсли;
	
	
	ОграничениеНулевойСуммыУслуг   = ВерсияФорматаЧислом(КомпонентыОбмена.ВерсияФорматаОбмена) < ВерсияФорматаЧислом("1.6");
		
	Запрос = Новый Запрос(
		"ВЫБРАТЬ ПЕРВЫЕ 1
		|	ИСТИНА КАК ЕстьНеСоответствующиеФормату
		|ИЗ
		|	Документ.ЗаказКлиента.Товары КАК Товары
		|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК НоменклатураСправочник
		|		ПО Товары.Номенклатура = НоменклатураСправочник.Ссылка
		|ГДЕ
		|	Товары.Ссылка = &Ссылка
		|	И Товары.Отменено = ЛОЖЬ
		|	И Товары.Сумма = 0
		|	И (НоменклатураСправочник.ТипНоменклатуры В (ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Услуга), ЗНАЧЕНИЕ(Перечисление.ТипыНоменклатуры.Работа))
		|				И &ОграничениеУслуг)");
	
	Запрос.УстановитьПараметр("Ссылка",      ДанныеИБ.Ссылка);
	Запрос.УстановитьПараметр("ОграничениеУслуг", ОграничениеНулевойСуммыУслуг);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ИспользованиеПКО.Документ_ЗаказКлиента_Отправка = РезультатЗапроса.Пустой();
	
	ПроверкаЗаполненияРеквизитовОбъектаИБ(ДанныеИБ, КомпонентыОбмена, ИспользованиеПКО);
КонецПроцедуры
