Процедура ПКО_Справочник_Упаковки_ИзСтруктуры_ПриОтправкеДанных(ДанныеИБ, ДанныеXDTO, КомпонентыОбмена, СтекВыгрузки)
	Если ДанныеИБ.Свойство("Ссылка") И ЗначениеЗаполнено(ДанныеИБ.Ссылка) Тогда
		ДанныеXDTO.КлючевыеСвойства.Вставить("Ссылка", ДанныеИБ.Ссылка);
	КонецЕсли;
	
	Коэффициент = ?(ДанныеИБ.Знаменатель = 0, ДанныеИБ.Числитель, Окр(ДанныеИБ.Числитель / ДанныеИБ.Знаменатель,3));
	
	Номенклатура = Неопределено;
	Если ВерсияФорматаЧислом(КомпонентыОбмена.ВерсияФорматаОбмена) >= ВерсияФорматаЧислом("1.6") Тогда
		Если ЗначениеЗаполнено(ДанныеИБ.Владелец) И ТипЗнч(ДанныеИБ.Владелец) = Тип("СправочникСсылка.Номенклатура") Тогда
			Номенклатура = ДанныеИБ.Владелец;
		КонецЕсли;
	КонецЕсли;
	
	Если СтекВыгрузки.Количество() > 1 Тогда
		ДанныеXDTO.Вставить("Коэффициент", Коэффициент);
		Если ЗначениеЗаполнено(Номенклатура) Тогда
			ДанныеXDTO.Вставить("Номенклатура", Номенклатура);
		КонецЕсли;
		Возврат;
	КонецЕсли;
	
	ДанныеXDTO.КлючевыеСвойства.Вставить("Коэффициент", Коэффициент);
	Если ЗначениеЗаполнено(Номенклатура) Тогда
		ДанныеXDTO.КлючевыеСвойства.Вставить("Номенклатура", Номенклатура);
	КонецЕсли;
	
	Если ВерсияФорматаЧислом(КомпонентыОбмена.ВерсияФорматаОбмена) < ВерсияФорматаЧислом("1.7") Тогда
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Высота) Тогда
			ДанныеXDTO.Вставить("Высота", -1);
		КонецЕсли;
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Глубина) Тогда
			ДанныеXDTO.Вставить("Глубина", -1);
		КонецЕсли;
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Объем) Тогда
			ДанныеXDTO.Вставить("Объем", -1);
		КонецЕсли;
		Если НЕ ЗначениеЗаполнено(ДанныеИБ.Ширина) Тогда
			ДанныеXDTO.Вставить("Ширина", -1);
		КонецЕсли;
	КонецЕсли;
КонецПроцедуры
