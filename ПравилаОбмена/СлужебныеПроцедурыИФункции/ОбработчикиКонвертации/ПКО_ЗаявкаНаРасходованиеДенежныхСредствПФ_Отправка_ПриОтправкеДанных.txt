Процедура ПКО_ЗаявкаНаРасходованиеДенежныхСредствПФ_Отправка_ПриОтправкеДанных(ДанныеИБ, ДанныеXDTO, КомпонентыОбмена, СтекВыгрузки)
	ХранимыйФайл = РаботаСФайлами.ДвоичныеДанныеФайла(ДанныеИБ.Ссылка);
	
	ДанныеXDTO.Вставить("ХранимыйФайл", ХранимыйФайл);
	
	ТЗЭлПодписи = Новый ТаблицаЗначений();
	ТЗЭлПодписи.Колонки.Добавить("Подпись");
	ТЗЭлПодписи.Колонки.Добавить("Сертификат");
	
	МассивЭлектронныхПодписей = ЭлектроннаяПодпись.УстановленныеПодписи(ДанныеИБ.Ссылка);
	Для Каждого ПодписьСтруктура Из МассивЭлектронныхПодписей Цикл
		СтрТЗ = ТЗЭлПодписи.Добавить();
		Если ТипЗнч(ПодписьСтруктура.Подпись) = Тип("ХранилищеЗначения") Тогда
			СтрТЗ.Подпись = ПодписьСтруктура.Подпись.Получить();
		Иначе
			СтрТЗ.Подпись = ПодписьСтруктура.Подпись;
		КонецЕсли;
		Если ТипЗнч(ПодписьСтруктура.Сертификат) = Тип("ХранилищеЗначения") Тогда
			СтрТЗ.Сертификат = ПодписьСтруктура.Сертификат.Получить();
		Иначе
			СтрТЗ.Сертификат = ПодписьСтруктура.Сертификат;
		КонецЕсли;
	КонецЦикла;
	Если ТЗЭлПодписи.Количество() > 0 Тогда
		ДанныеXDTO.Вставить("ЭлектронныеПодписи", ТЗЭлПодписи);
	КонецЕсли;	
	
	ТЗСертификаты = Новый ТаблицаЗначений();
	ТЗСертификаты.Колонки.Добавить("Сертификат");
	МассивСертификатовШифрования = ЭлектроннаяПодпись.СертификатыШифрования(ДанныеИБ.Ссылка);
	Для Каждого СертификатСтруктура Из МассивСертификатовШифрования Цикл
		СтрТЗ = ТЗСертификаты.Добавить();
		Если ТипЗнч(СертификатСтруктура.Сертификат) = Тип("ХранилищеЗначения") Тогда
			СтрТЗ.Сертификат = СертификатСтруктура.Сертификат.Получить();
		Иначе
			СтрТЗ.Сертификат = СертификатСтруктура.Сертификат;
		КонецЕсли;
	КонецЦикла;
	Если ТЗСертификаты.Количество() > 0 Тогда
		ДанныеXDTO.Вставить("СертификатыШифрования", ТЗСертификаты);
	КонецЕсли;
КонецПроцедуры
