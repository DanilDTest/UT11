Процедура ПКО_Документ_СборкаТоваров_Получение_ПередЗаписьюПолученныхДанных(ПолученныеДанные, ДанныеИБ, КонвертацияСвойств, КомпонентыОбмена)
	ЗаполнитьСкладПоУмолчанию(ПолученныеДанные, ДанныеИБ, КомпонентыОбмена);
	ЗагрузитьДополнительныеСведения(?(ДанныеИБ = Неопределено, ПолученныеДанные.ПолучитьСсылкуНового(), ДанныеИБ.Ссылка), 
							ПолученныеДанные.ДополнительныеСвойства, КомпонентыОбмена);
	
	ДанныеДляЗаписиВИБ = ?(ДанныеИБ = Неопределено, ПолученныеДанные, ДанныеИБ);
	
	      
	Если ДанныеИБ <> Неопределено Тогда    
	
		Если НЕ ЗначениеЗаполнено(ПолученныеДанные.НоменклатураОсновногоКомпонента) Тогда
			ПолученныеДанные.НоменклатураОсновногоКомпонента = ДанныеИБ.НоменклатураОсновногоКомпонента;
		КонецЕсли; 
		
		Если НЕ ЗначениеЗаполнено(ПолученныеДанные.Статус) Тогда
			ПолученныеДанные.Статус = ДанныеИБ.Статус;
		КонецЕсли; 
	
		ЗаполнитьСвойстваШапкиОбъекта(КонвертацияСвойств, ПолученныеДанные, ДанныеИБ);
		ДанныеИБ.Товары.Загрузить(ПолученныеДанные.Товары.Выгрузить());
		                                  
		ПолученныеДанные = Неопределено;   
	Иначе     
	    
	    Если НЕ ЗначениеЗаполнено(ПолученныеДанные.Статус) Тогда
	    	ДанныеДляЗаписиВИБ.Статус = Перечисления.СтатусыСборокТоваров.СобраноРазобрано;
	    КонецЕсли;   
	    
	КонецЕсли;  
	
	Если НЕ ЗначениеЗаполнено(ДанныеДляЗаписиВИБ.НоменклатураОсновногоКомпонента) 
		И ДанныеДляЗаписиВИБ.Статус = Перечисления.СтатусыСборокТоваров.СобраноРазобрано   
		И ДанныеДляЗаписиВИБ.ХозяйственнаяОперация = Перечисления.ХозяйственныеОперации.СборкаТоваров  
		И ДанныеДляЗаписиВИБ.Товары.Количество() = 1 Тогда	
	 
		ВестиУчетПоГТД = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(ДанныеДляЗаписиВИБ.Номенклатура, "ВестиУчетПоГТД");
		Если ВестиУчетПоГТД = Истина Тогда 
			ДанныеДляЗаписиВИБ.НоменклатураОсновногоКомпонента = ДанныеДляЗаписиВИБ.Товары[0].Номенклатура; 
		КонецЕсли;
		
	КонецЕсли; 
	
	Если НЕ ЗначениеЗаполнено(ДанныеДляЗаписиВИБ.ДатаРаспоряжения) Тогда
		ДанныеДляЗаписиВИБ.ДатаРаспоряжения = ДанныеДляЗаписиВИБ.Дата;
	КонецЕсли;
	Если НЕ ЗначениеЗаполнено(ДанныеДляЗаписиВИБ.Упаковка) Тогда
		ДанныеДляЗаписиВИБ.КоличествоУпаковок = ДанныеДляЗаписиВИБ.Количество;
	КонецЕсли;
КонецПроцедуры
